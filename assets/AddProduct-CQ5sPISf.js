import{_ as I,u as L,m as x,z as O,c as D,b as R,w as c,d as $,e as s,g as b,f as t,T as h,i as d,x as y,t as u,p as j,h as f,q as n,k as P,v,F as C,j as V,y as T,A as F}from"./index-CSEyxdT9.js";import{M as z,u as K}from"./imageUpload-BcmgLVOm.js";import{_ as W}from"./AppLayout-B6hHIpEb.js";import{_ as q}from"./ErrorMessage-gaV-nPEj.js";import"./Footer-CwoNZgPF.js";const G={key:0,class:"fixed left-4 top-20 sm:left-8 sm:top-24 bg-red-500 dark:bg-red-600 text-white px-4 py-3 rounded-lg shadow-lg text-sm font-medium max-w-sm animate-pulse z-50"},J={key:0,class:"fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-green-500 dark:bg-green-600 text-white px-6 py-4 rounded-lg shadow-lg text-sm font-medium max-w-sm animate-bounce z-50"},H={class:"max-w-2xl mx-auto"},Q={class:"bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6 sm:p-8"},X={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Y=["value"],Z={key:0,class:"mt-3"},ee={key:0,class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},te={class:"font-semibold text-primary"},re={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ae=["value"],se={key:0,class:"text-xs text-red-500 dark:text-red-400 mt-2"},oe={key:0,class:"mt-3"},le=["src"],de={class:"flex flex-col sm:flex-row gap-3 sm:gap-4 pt-4"},ie=["disabled"],ne={__name:"AddProduct",setup(ue){const S=$(),m=L(),A=z,i=x(""),o=x(""),E=x(""),g=x(""),U=x(""),k=x(""),a=O({title:"",description:"",category:"",price:0,stock:0,unit:"units",thumbnail:""}),M=l=>l?l.charAt(0).toUpperCase()+l.slice(1).toLowerCase():"",N=D(()=>{if(!a.price)return"KES 0.00";const l=(a.price*m.currentRate).toFixed(2),[e,r]=l.split(".");return"KES "+e.replace(/\B(?=(\d{3})+(?!\d))/g,",")+"."+r}),B=async()=>{if(o.value="",E.value="",!a.title.trim()){o.value="Please enter a product title",p();return}if(!a.description.trim()){o.value="Please enter a product description",p();return}if(!i.value||i.value===""){o.value="Please select a category",p();return}if(i.value==="Other"&&!a.category.trim()){o.value="Please enter a custom category name",p();return}if(!a.thumbnail.trim()&&!k.value){o.value="Please provide a thumbnail URL or upload an image",p();return}const l=i.value==="Other"?a.category.toLowerCase():i.value;a.category=l,k.value&&(a.thumbnail=k.value);const e=await m.addProduct(a);e.success?(F().addNotification("Product added successfully!","success",3e3),await new Promise(w=>setTimeout(w,500)),S.push(`/products/${e.data.id}`)):(o.value=e.error||"Failed to add product",p())},p=()=>{setTimeout(()=>{o.value=""},3e3)},_=async l=>{var w;g.value="";const e=(w=l.target.files)==null?void 0:w[0];if(!e)return;const r=await K(e);r.success?(k.value=r.base64,U.value=r.dataUrl,g.value=""):(g.value=r.error,k.value="",setTimeout(()=>{g.value=""},3e3))};return(l,e)=>(s(),R(W,null,{default:c(()=>[b(h,{name:"slide-in-left"},{default:c(()=>[o.value?(s(),d("div",G," ðŸ”´ "+u(o.value),1)):y("",!0)]),_:1}),b(h,{name:"slide-up"},{default:c(()=>[E.value?(s(),d("div",J," âœ“ "+u(E.value),1)):y("",!0)]),_:1}),t("div",H,[e[24]||(e[24]=t("h1",{class:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-4 sm:mb-6"},"Add New Product",-1)),t("div",Q,[t("form",{onSubmit:j(B,["prevent"]),class:"space-y-4 sm:space-y-6"},[b(q,{message:f(m).error},null,8,["message"]),t("div",null,[e[10]||(e[10]=t("label",{for:"title",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[P(" Title "),t("span",{class:"text-red-500"},"*")],-1)),n(t("input",{id:"title","onUpdate:modelValue":e[0]||(e[0]=r=>a.title=r),type:"text",required:"",class:"w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-white",placeholder:"Enter product title"},null,512),[[v,a.title]])]),t("div",null,[e[11]||(e[11]=t("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[P(" Description "),t("span",{class:"text-red-500"},"*")],-1)),n(t("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=r=>a.description=r),rows:"4",class:"w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-white",placeholder:"Enter product description"},null,512),[[v,a.description]])]),t("div",X,[t("div",null,[e[15]||(e[15]=t("label",{for:"category",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[P(" Category "),t("span",{class:"text-red-500"},"*")],-1)),n(t("select",{id:"category","onUpdate:modelValue":e[2]||(e[2]=r=>i.value=r),class:"w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},[e[12]||(e[12]=t("option",{value:""},"-- Select a category --",-1)),(s(!0),d(C,null,V(f(m).categories,r=>(s(),d("option",{key:r,value:r},u(M(r)),9,Y))),128)),e[13]||(e[13]=t("option",{value:"Other"},"Other",-1))],512),[[T,i.value]]),b(h,{name:"fade-down"},{default:c(()=>[i.value==="Other"?(s(),d("div",Z,[n(t("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>a.category=r),type:"text",placeholder:"Enter custom category",class:"w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},null,512),[[v,a.category]]),e[14]||(e[14]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Enter a custom category name",-1))])):y("",!0)]),_:1})]),t("div",null,[e[17]||(e[17]=t("label",{for:"price",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Price (USD) ",-1)),n(t("input",{id:"price","onUpdate:modelValue":e[4]||(e[4]=r=>a.price=r),type:"number",step:"0.01",min:"0",class:"w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-white",placeholder:"0.00"},null,512),[[v,a.price,void 0,{number:!0}]]),a.price?(s(),d("div",ee,[e[16]||(e[16]=P(" Converts to: ",-1)),t("span",te,u(N.value),1)])):y("",!0)])]),t("div",re,[t("div",null,[e[18]||(e[18]=t("label",{for:"stock",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Stock ",-1)),n(t("input",{id:"stock","onUpdate:modelValue":e[5]||(e[5]=r=>a.stock=r),type:"number",min:"0",class:"w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-white",placeholder:"0"},null,512),[[v,a.stock,void 0,{number:!0}]])]),t("div",null,[e[19]||(e[19]=t("label",{for:"unit",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Measurement Unit ",-1)),n(t("select",{id:"unit","onUpdate:modelValue":e[6]||(e[6]=r=>a.unit=r),class:"w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},[(s(!0),d(C,null,V(f(A),r=>(s(),d("option",{key:r.value,value:r.value},u(r.label),9,ae))),128))],512),[[T,a.unit]])])]),t("div",null,[e[20]||(e[20]=t("label",{for:"thumbnail",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Thumbnail URL ",-1)),n(t("input",{id:"thumbnail","onUpdate:modelValue":e[7]||(e[7]=r=>a.thumbnail=r),type:"text",class:"w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-white",placeholder:"https://example.com/image.jpg (or upload below)"},null,512),[[v,a.thumbnail]]),e[21]||(e[21]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Optional if image is uploaded",-1))]),t("div",null,[e[22]||(e[22]=t("label",{for:"imageUpload",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Upload Image ",-1)),t("input",{id:"imageUpload",type:"file",accept:"image/*",onChange:_,class:"w-full px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},null,32),e[23]||(e[23]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"PNG, JPEG, WEBP (Max 3MB)",-1)),b(h,{name:"fade-down"},{default:c(()=>[g.value?(s(),d("p",se,u(g.value),1)):y("",!0)]),_:1}),b(h,{name:"fade-down"},{default:c(()=>[U.value?(s(),d("div",oe,[t("img",{src:U.value,alt:"Preview",class:"w-20 sm:w-24 h-20 sm:h-24 object-cover rounded border dark:border-gray-600",onError:e[8]||(e[8]=r=>U.value="/fallback.jpg")},null,40,le)])):y("",!0)]),_:1})]),t("div",de,[t("button",{type:"submit",disabled:f(m).isLoading,class:"flex-1 bg-primary text-white py-2 px-4 rounded-lg hover:opacity-80 transition disabled:opacity-50 text-sm sm:text-base"},u(f(m).isLoading?"Adding...":"Add Product"),9,ie),t("button",{type:"button",onClick:e[9]||(e[9]=r=>f(S).push("/products")),class:"flex-1 bg-gray-300 dark:bg-gray-700 text-gray-700 dark:text-gray-300 py-2 px-4 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-600 transition text-sm sm:text-base"}," Cancel ")])],32)])])]),_:1}))}},be=I(ne,[["__scopeId","data-v-a4145931"]]);export{be as default};
